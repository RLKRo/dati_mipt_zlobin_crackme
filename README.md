# dati_mipt_zlobin_crackme

# 13.   CrackMe. Зверская) задача

Вам дана программа crackme [http://tiny.cc/s304nz] (измените расширение файла на .exe), которая ожидает от вас логин и пароль. Патчить программу нельзя. Напишите keygen - консольное или оконное/графическое решение, которая принимает на вход логин (проверяет валидный ли логин) и возвращает минимум один пароль, подходящие для crackme. Оцениваться будет не только решение, но и стиль кода, его архитектура.

# Решение

Дизассемблируем программу. Изначально это было сделано с помощью radare2:
```
$ radare2 ~/Downloads/crackme.exe
[0x00401000]> pd $s | less >> crackme.asm
```
Результат выполнения находится в 'crackme.asm'. Секция Code находится в 'crackme_code.asm'.

На 243 строке на 0x0040134d offset начинается функция, выводящая требуемое сообщение "Good work!". Посмотрим, где вызывается 'call 0x40134d'. Это происходит на 166 строке на 0x0040124c offset. В это место можно попасть из инструкции 'je 0x40124c' на 0x00401243 offset, которая производит прыжок, если значения регистров eax и ebx совпадают ('cmp eax, ebx').

На этом месте анализировать код из этого файла стало сложнее, поэтому далее используется IDA Pro.

